# Turn off MultiViews
Options -MultiViews

# Directive to ensure *.rdf files served as appropriate content type
AddType application/rdf+xml .rdf
AddType application/rdf+xml .owl
AddType text/turtle .ttl
AddType application/n-triples .n3
AddType application/ld+json .jsonld

RewriteEngine On
RewriteBase /

# -----------------------------------------------------------------------------
# NEW RULES FOR MODULAR VOCABULARIES
# -----------------------------------------------------------------------------
# These rules redirect specific requests to the raw .ttl files on GitHub.
# We use [R=303,L] (See Other, Last rule) to comply with Semantic Web standards.

RewriteRule ^vocabularies/sector-scheme$ https://raw.githubusercontent.com/KhaosResearch/EDAAnOWL/main/docs/vocabularies/sector-scheme.ttl [R=303,L]
RewriteRule ^vocabularies/agro-vocab$ https://raw.githubusercontent.com/KhaosResearch/EDAAnOWL/main/docs/vocabularies/agro-vocab.ttl [R=303,L]
RewriteRule ^vocabularies/observed-properties$ https://raw.githubusercontent.com/KhaosResearch/EDAAnOWL/main/docs/vocabularies/observed-properties.ttl [R=303,L]
RewriteRule ^vocabularies/datatype-scheme$ https://raw.githubusercontent.com/KhaosResearch/EDAAnOWL/main/docs/vocabularies/datatype-scheme.ttl [R=303,L]

# -----------------------------------------------------------------------------
# RULES FOR THE MAIN ONTOLOGY (Existing, slightly adjusted)
# -----------------------------------------------------------------------------

# 1. If HTML is requested (browser), redirect to Widoco documentation
RewriteCond %{HTTP_ACCEPT} !application/rdf\+xml.*(text/html|application/xhtml\+xml)
RewriteCond %{HTTP_ACCEPT} text/html [OR]
RewriteCond %{HTTP_ACCEPT} application/xhtml\+xml [OR]
RewriteCond %{HTTP_USER_AGENT} ^Mozilla/.*
RewriteRule ^$ https://khaosresearch.github.io/EDAAnOWL/ontology/index-en.html [R=303,L]

# 2. Redirect specific terms (hash) to their anchor in the HTML documentation
RewriteCond %{HTTP_ACCEPT} !application/rdf\+xml.*(text/html|application/xhtml\+xml)
RewriteCond %{HTTP_ACCEPT} text/html [OR]
RewriteCond %{HTTP_ACCEPT} application/xhtml\+xml [OR]
RewriteCond %{HTTP_USER_AGENT} ^Mozilla/.*
RewriteRule ^(.+) https://khaosresearch.github.io/EDAAnOWL/ontology/index-en.html#$1 [R=303,NE,L]

# 3. If RDF is requested (Protege, tools), serve the main Turtle file (.ttl)
# (Updated to point to your .ttl, which is the source of truth)
RewriteCond %{HTTP_ACCEPT} (text/turtle|application/n-triples|application/ld+json|application/rdf\+xml)
RewriteRule ^$ https://raw.githubusercontent.com/KhaosResearch/EDAAnOWL/main/docs/ontology/edaan-owl.ttl [R=303,L]

# 4. Default fallback -> main Turtle file
RewriteRule ^$ https://raw.githubusercontent.com/KhaosResearch/EDAAnOWL/main/docs/ontology/edaan-owl.ttl [R=303,L]
